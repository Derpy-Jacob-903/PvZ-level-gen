<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
</head>

<body>
    <div> Please choose an alias: </div>
    <select id="reee" onchange="">
        <option>Endangered</option>
        <option>ModifyPlantCooldown</option>
        <option>SunBombs</option>
        <option>FasterZombies</option>
        <option>LootOverride</option>
        <option>Pirate Seas' plank</option>
        <option>Rails/Railcarts</option>
        <option>ItemSpawn</option>
        <option>InitialPlantPlacements</option>
        <option>InitialZombiePlacements</option>
        <option disabled>Challenges:</option>
        <option>SunProduced</option>
        <option>SimutaneousPlants</option>
        <option>PlantsLost</option>
        <option>MoldColonies</option> <!--wtf this one-->
    </select>
    <button type="button" onclick="onAliasSelect();">Select!</button>
    <form>
        <fieldset id='myGroupBox'>

        </fieldset>
    </form>

    <script>
        // ui elements
        var myGroupBox;

        //data variables
        var userInput = {};
        var myGrid;
        var rails = [];
        var railCarts = [];
        var itemsObj = {};
        var spawnObj = [];
        var iPCount;
        var maxPCount;
        var spawnTimer = {};

        //functions
        var completeObjdata;

        //global scope to define when should createObj() run:
        var runCreateObj = {};

        // file object
        var challengeModules = {}, fileObj = {}, challengeModulesDefinition = [];

        function onAliasSelect() {
            myGroupBox = document.getElementById("myGroupBox");
            chosen = document.getElementById("reee").selectedIndex;
            //alert("Chosen: "+ chosen);

            switch (chosen) {
                case 0:
                    handleEndangered();
                    break;
                case 1:
                    handleModifyPlantCooldown();
                    break;
                case 2:
                    handleSunBombs();
                    break;
                case 3:
                    handleSpeedyZombie();
                    break;
                case 4:
                    handleLootOverride();
                    break;
                case 5:
                    handlePlank();
                    break;
                case 6:
                    handleRails();
                    break;
                case 7:
                    handlePotion();
                    break;
                case 8:
                    handleIntPlants();
                    break;
                case 9:
                    handleIntZombies();
                    break;
                case 10:
                    handleGridItems();
                    break;
                //break case 11 cuz not selectable
                case 11:
                    handleSunProduced();
                    break;
                case 12:
                    handleMaxPlants();
                    break;
                case 13:
                    handleMaxPlantsLost();
                    break;
                case 14:
                    handleMold(); //WHY THE FUCK AM I HERE ALREADY
                    break;
                default:
                //hacker detected!!
            };
        }


        function handleEndangered() {
            myGrid = {
                "className": "Endangered",
                "data": [
                    { "name": "GridX", "id": "gridxID", "displayTxt": "Provide GridX: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "GridY", "id": "gridyID", "displayTxt": "Provide GridY: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "PlantType", "id": "plantType", "displayTxt": "Provide a plant's name (internal): ", "type": "text" }
                ]
            };
            runCreateObj.toSubmit = true;
            createUI();

            //all var to create ed plants
            var ePlants = [], endangeredObj = {}, eAlias = ["ProtectThePlant"], ePlantsData = {};
            completeObjdata = function () {
                runCreateObj.run = true;
                ePlants.push(userInput)
                function createObj() {
                    endangeredObj.aliases = eAlias;
                    endangeredObj.objclass = "ProtectThePlantChallengeProperties";
                    ePlantsData.MustProtectCount = ePlants.length;
                    ePlantsData.Plants = ePlants;
                    endangeredObj.objdata = ePlantsData;
                    console.log(JSON.stringify(endangeredObj))
                }
                completeObjdata.createObj = createObj;
            }
        }

        function handleModifyPlantCooldown() {
            myGrid = {
                "className": "ModifyPlantCooldown",
                "data": [
                    { "name": "CooldownMultiplier", "id": "cooldownMod", "displayTxt": "Define CooldownMultiplier", "type": "number", "min": "", "max": "" },
                    { "name": "HomeworldToExcludeFromOverride", "id": "cooldownExclusion", "displayTxt": "Exclude a homeworld from CooldownMod", "type": "text" }
                ]
            };
            createUI();
            completeObjdata = function () {
                runCreateObj.run = false;
                var cModObj = {}, cModAlias = ["CooldownMod"];
                cModObj.aliases = cModAlias;
                cModObj.objclass = "PlantCooldownModifierProperties";
                cModObj.objdata = userInput;
                console.log(JSON.stringify(cModObj));
            }
        }

        function handleSunBombs() {
            myGrid = {
                "className": "SunBombs",
                "data": [
                    { "name": "PlantBombExplosionRadius", "id": "pBombRadius", "displayTxt": "Range SunBombs will apply to plants: ", "type": "number", "min": "0", "max": "" },
                    { "name": "ZombieBombExplosionRadius", "id": "zBombRadius", "displayTxt": "Range SunBombs will apply to zombies: ", "type": "number", "min": "0", "max": "" },
                    { "name": "PlantDamage", "id": "sBombpDamage", "displayTxt": "How hurtful will the bomb be to plants? ", "type": "number", "min": "0", "max": "" },
                    { "name": "ZombieDamage", "id": "sBombzDamage", "displayTxt": "How hurtful will the bomb be to zombies? ", "type": "number", "min": "0", "max": "" }
                ]
            };
            createUI();
            completeObjdata = function () {
                runCreateObj.run = false;
                var sBombsObj = {}, sBombsAlias = ["SunBombChallengeProperties"];
                sBombsObj.aliases = sBombsAlias;
                sBombsObj.objclass = "SunBombChallengeProperties";
                sBombsObj.objdata = userInput;
                console.log(JSON.stringify(sBombsObj));
            }
        }

        function handleSpeedyZombie() {
            myGrid = {
                "className": "FasterZombies",
                "data": [
                    { "name": "Speedy", "id": "speedChk", "displayTxt": "Will zombies in this level be faster than normal? (checked is true) ", "type": "checkbox" }
                ]
            };
            createUI();
            //var originalInput = document.getElementById('spedUpz');
            //var newCheckbox = document.createElement("input");
            //newCheckbox.setAttribute("type", "checkbox");
            //newCheckbox.setAttribute("id", "speedChk");
            /*find parent node*/
            //var parentDiv = originalInput.parentNode;
            //parentDiv.replaceChild(newCheckbox, originalInput);
            completeObjdata = function () {
                runCreateObj.run = false;
                var speedyObj = {}, speedyAlias = ["SpeedyZombies"], speedyObjdata = {}
                speedyObj.aliases = speedyAlias;
                speedyObj.objclass = "SpeedyZombies";
                var chkBox = document.getElementById("speedChk");
                if (chkBox.checked == true) {
                    speedyObjdata.Speedy = true;
                }
                else {
                    speedyObjdata.Speedy = false;
                }
                speedyObj.objdata = speedyObjdata;
                console.log(JSON.stringify(speedyObj))
            }
        }

        function handleLootOverride() {
            myGrid = {
                "className": "LootOverride",
                "data": [
                    { "name": "ZombieType", "id": "lootOverrideZType", "displayTxt": "Choose a zombie to override loot drop (internal): ", "type": "text" },
                    { "name": "LootOverride", "id": "lootToOverride", "displayTxt": "Override with which type of loot? ", "type": "text" }
                ]
            };runCreateObj.toSubmit = true;
            createUI();
            var lootOverrideArray = [], lootOverrideAlias = ["LootOverride"], lootOverrideObj = {}, lootOverrideObjdata = {}, validZType;
            completeObjdata = function () {
                runCreateObj.run = true;
                
                validZType = "RTID(" + userInput.ZombieType + "@ZombieTypes)";
                var realOverride = {};
                realOverride[myGrid.data[0].name] = validZType;
                realOverride[myGrid.data[1].name] = userInput.LootOverride;
                lootOverrideArray.push(realOverride);
                function createObj() {
                    lootOverrideObj.aliases = lootOverrideAlias;
                    lootOverrideObj.objclass = "LootOverrideModuleProperties";
                    lootOverrideObjdata.Overrides = lootOverrideArray;
                    lootOverrideObj.objdata = lootOverrideObjdata;
                    console.log(JSON.stringify(lootOverrideObj));
                }
                completeObjdata.createObj = createObj;
            }
        }

        function handlePlank() {
            myGrid = {
                "className": "Plank",
                "data": [
                    { "name": "PlankRows", "id": "PSPlank", "displayTxt": "Which row do you want to place plank on? (only work for Pirate Seas) ", "type": "number", "min": "0", "max": "4" }
                ]
            };runCreateObj.toSubmit = true;
            createUI();
            var plankRows = [], plankObj = {}, plankObjdata = {}, plankAlias = ["PiratePlanks"];
            completeObjdata = function () {
                runCreateObj.run = true;
                plankRows.push(userInput);
                function createObj() {
                    plankObj.aliases = plankAlias;
                    plankObj.objclass = "PiratePlankProperties";
                    plankObjdata.PlankRows = plankRows;
                    plankObj.objdata = plankObjdata;
                    console.log(JSON.stringify(plankObj));
                }
                completeObjdata.createObj = createObj;
            }
        }

        function handleRails() {
            rails = [];
            railCarts = [];
            createRailsUI();

            var railsRows = [], railsObj = {}, railsObjdata = {}, railsAlias = ["CowboyRails"];
            completeObjdata = function () {
                function createObj() {
                    railsObj.aliases = railsAlias;
                    railsObj.objclass = "RailCartProperties";
                    railsObj.objdata = userInput;
                    console.log(JSON.stringify(railsObj));
                };
                completeObjdata.createObj = createObj;
            }
        }

        function createRailsUI() {
            clearInputArea();
            addText("Railcart type: ");
            myGroupBox.appendChild(createInput('text', 'railCartTypeID', 'myClass', 'railcart_cowboy'));
            newLine(); newLine();

            //add rails first
            addText("Add rails: "); newLine();
            addText("Column: "); createInput('number', 'railColumnID', 'myClass', 1); addText("  ");
            addText("Row Start: "); createInput('number', 'railRowStartID', 'myClass', 1); addText("  ");
            addText("Row End: "); createInput('number', 'railRowEndID', 'myClass', 3); addText("  ");

            var clickHandler = function () {
                var myRail = {};
                rails.push(myRail);
                myRail['Column'] = readIntInput("railColumnID");
                myRail['RowStart'] = readIntInput("railRowStartID");
                myRail['RowEnd'] = readIntInput("railRowEndID");
                console.log('Added rail: ' + JSON.stringify(myRail));
            };
            myGroupBox.appendChild(createButton('Add', clickHandler));

            clickHandler = function () {
                rails = [];
            };
            myGroupBox.appendChild(createButton('Clear all rails', clickHandler));
            newLine(); newLine();

            //add carts
            addText("Add Rail Carts: "); newLine();
            addText("Column: "); createInput('number', 'railCartColumnID', 'myClass', 1); addText("  ");
            addText("Row: "); createInput('number', 'railCartRowID', 'myClass', 1); addText("  ");

            clickHandler = function () {
                var myRailCart = {};
                railCarts.push(myRailCart);
                myRailCart['Column'] = readIntInput("railCartColumnID");
                myRailCart['Row'] = readIntInput("railCartRowID");
                console.log('Added rail cart: ' + JSON.stringify(myRailCart));
            };
            myGroupBox.appendChild(createButton('Add', clickHandler));

            clickHandler = function () {
                railCarts = [];
            };
            myGroupBox.appendChild(createButton('Clear all carts', clickHandler));
            newLine(); newLine();


            //submit buttons
            clickHandler = function () {
                userInput = readRailsData();
                completeObjdata();
                //instead of setting all input to blank, just create new ui.
                createRailsUI();
            };
            //myGroupBox.appendChild(createButton('Submit', clickHandler));


            clickHandler = function () {
                userInput = readRailsData();
                completeObjdata();
                completeObjdata.createObj();
            };
            myGroupBox.appendChild(createButton('Submit and generate chosen object', clickHandler));
        }
        //okay item spawn, this is a f*cking mess
        function handlePotion() {
            addPotionUI();
            var itemsAlias = ['GridItemSpawn'];
            completeObjdata = function () {
                function createObj() {
                    itemsObj.aliases = itemsAlias;
                    itemsObj.objclass = "ZombiePotionModuleProperties";
                    itemsObj.objdata = userInput;
                    console.log(JSON.stringify(itemsObj));
                };
                completeObjdata.createObj = createObj;
            }
        }

        function readRailsData() {
            var a = {};
            a['RailCartType'] = readTxtInput("railCartTypeID");
            a['Rails'] = rails;
            a['RailCarts'] = railCarts;
            return a;
        }

        function addPotionUI() {
            clearInputArea();
            addText('How many items do you want to leave at start? ');
            myGroupBox.appendChild(createInput('number', 'itemPrePlaceNumber', 'potionClass', ''));
            addText('Maximum amount of items on the lawn?  ');
            myGroupBox.appendChild(createInput('number', 'itemMaxNumber', 'potionClass', ''));
            // handle 2 first obj
            var clickHandler = function () {
                iPCount = readIntInput('itemPrePlaceNumber');
                maxPCount = readIntInput('itemMaxNumber');
                clickHandler.onclick = function () { document.getElementById('toBeDisabled').disabled = true; }
            };
            myGroupBox.appendChild(createButton('Confirm', clickHandler, 'toBeDisabled'));
            newLine(); newLine();
            //create potion timer
            addText('Configure potions:');
            addText('Maximum time to spawn item:  '); myGroupBox.appendChild(createInput('number', 'itemMaxSpawnTime', 'potionClass', '')); addText(" ");
            addText('Minimum time to spawn item: '); myGroupBox.appendChild(createInput('number', 'itemMinSpawnTime', 'potionClass', '')); addText(" ");
            //handle time
            clickHandler = function () {
                spawnTimer.Max = readIntInput('itemMaxSpawnTime');
                spawnTimer.Min = readIntInput('itemMinSpawnTime');
                clickHandler.onclick = function () { document.getElementById('toBeDisabled2').disabled = true; };
            }
            myGroupBox.appendChild(createButton('Confirm', clickHandler, 'toBeDisabled2'));
            newLine(); newLine();
            addText('What do you want to spawn? '); myGroupBox.appendChild(createInput('text', 'itemToSpawn', 'itemSpawnId', ''))
            //lol handler
            clickHandler = function () {
                spawnObj.push(readTxtInput('itemToSpawn'))
            };
            myGroupBox.appendChild(createButton('Add', clickHandler));
            clickHandler = function () {
                userInput = readItemsData();
                completeObjdata();
                completeObjdata.createObj();
                clickHandler.onclick = function () { document.getElementById('toBeDisabled3').disabled = true; }
            };
            myGroupBox.appendChild(createButton('Generate chosen object', clickHandler, 'toBeDisabled3'));
        }
        function handleIntPlants() {
            myGrid = {
                "data": [
                    { "name": "IsInitialIntensiveCarrotPlacements", "id": "intPlantsBurn", "displayTxt": "Burn all plants at the start of the level?", "type": "checkbox" },
                    { "name": "Condition", "id": "intConditions", "displayTxt": "Conditions?", "type": "number" },
                    { "name": "GridX", "id": "gridxIDInt", "displayTxt": "Provide GridX: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "GridY", "id": "gridyIDInt", "displayTxt": "Provide GridY: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "Level", "id": "intPlantLvl", "displayTxt": "What level will it be? (-1 for current level)", "type": "number" },
                    { "name": "PlantType", "id": "plantTypeInt", "displayTxt": "Provide a plant's name (internal): ", "type": "text" }
                ]
            }
            runCreateObj.toSubmit = true;
            createUI();
            var intPlants = [], intPObj = {}, intAlias = ["InitialPlants"], intPlantsData = {}, confirmLastOfObj = [];
            completeObjdata = function () {
                runCreateObj.run = true;
                confirmLastOfObj.push(document.getElementById("intPlantsBurn").checked);
                delete userInput.IsInitialIntensiveCarrotPlacements;//just to make sure it doesn't log this one every time the user loops
                intPlants.push(userInput);
                function createObj() {
                    intPObj.aliases = intAlias;
                    intPObj.objclass = "InitialPlantProperties";
                    intPlantsData.IsInitialIntensiveCarrotPlacements = confirmLastOfObj.pop();
                    intPlantsData.InitialPlantPlacements = intPlants;
                    intPObj.objdata = intPlantsData;
                    console.log(JSON.stringify(intPObj));
                }
                completeObjdata.createObj = createObj;
            }
        }

        function handleIntZombies() {
            myGrid = {
                "data": [
                    { "name": "Condition", "id": "intZConditions", "displayTxt": "Conditions? ", "type": "number" },
                    { "name": "GridX", "id": "gridxIDInt", "displayTxt": "Provide GridX: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "GridY", "id": "gridyIDInt", "displayTxt": "Provide GridY: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "TypeName", "id": "plantTypeInt", "displayTxt": "Provide a zombie's name (internal): ", "type": "text" }
                ]
            }
            runCreateObj.toSubmit = true;
            createUI();
            var intZombies = [], intZObj = {}, intZAlias = ["InitialZombies"], intZData = {};
            completeObjdata = function () {
                runCreateObj.run = true;
                intZombies.push(userInput);
                function createObj() {
                    intZObj.aliases = intZAlias;
                    intZObj.objclass = "InitialZombieProperties";
                    intZData.InitialZombiePlacements = intZombies;
                    intZObj.objdata = intZData;
                    console.log(JSON.stringify(intZObj))
                }
                completeObjdata.createObj = createObj;
            }
        }

        function handleGridItems() {
            myGrid = {
                "data": [
                    { "name": "GridX", "id": "gridxIDInt", "displayTxt": "Provide GridX: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "GridY", "id": "gridyIDInt", "displayTxt": "Provide GridY: ", "type": "number", "min": "0", "max": "9" },
                    { "name": "TypeName", "id": "plantTypeInt", "displayTxt": "Provide an item's name (internal): ", "type": "text" }
                ]
            }
            runCreateObj.toSubmit = true;
            createUI();
            var intItems = [], intIObj = {}, intIAlias = ['InitialGridItem'], intIData = {};
            completeObjdata = function () {
                runCreateObj.run = true;
                intItems.push(userInput);
                function createObj() {
                    intIObj.aliases = intIAlias;
                    intIObj.objclass = "InitialGridItemProperties";
                    intIData.InitialGridItemProperties = intItems;
                    intIObj.objdata = intIData;
                }
                completeObjdata.createObj = createObj;
            }
        }

        function handleSunProduced() {
            myGrid = {
                "data": [
                    {"name":"TargetSun", "id":"targetSun", "displayTxt":"Target sun to produce: ","type":"number", "min": "0", "max":""}
                ]
            }
            createUI();
            var sunPAlias = ['SunProduced'], sunPObj = {};
            completeObjdata = function () {
                runCreateObj.run = false;
                sunPObj.aliases = sunPAlias;
                sunPObj.objclass = "StarChallengeSunProducedProps";
                sunPObj.objdata = userInput;
                console.log(JSON.stringify(sunPObj))
            }
        }

        function handleMaxPlants() {
            myGrid = {
                "data": [
                    {"name": "MaximumPlants","id":"maxPlantId",'displayTxt':'Maximum amount of plants allowed onscreen? ', 'type':'number', 'min':'0', 'max':''}
                ]
            }
            createUI();
            var maxPlantsAlias = ["SimultaneousPlants"], maxPlantsObj = {};
            completeObjdata = function () {
                runCreateObj.run = false;
                maxPlantsObj.aliases = maxPlantsAlias;
                maxPlantsObj.objclass = "StarChallengeSimultaneousPlantsProps";
                max
            }
        }

        function myReadData() {
            var a = {};
            myGrid.data.forEach(function insertObject(aliasesObject) {
                var val = document.getElementById(aliasesObject.id).value;
                if (val != "") {
                    if (aliasesObject.type === "number") { val = parseInt(val); }
                    a[aliasesObject.name] = val;
                }
            }

            );
            return a;
        }

        function readRailsData() {
            var a = {};
            a['RailCartType'] = readTxtInput("railCartTypeID");
            a['Rails'] = rails;
            a['RailCarts'] = railCarts;
            return a;
        }
        //utilities
        //-------------------------------------------------------
        function clearInputArea() {
            while (myGroupBox.firstChild) {
                myGroupBox.removeChild(myGroupBox.firstChild);
            }
            myGroupBox.appendChild(document.createElement('br'))
        }

        //clears previous and create new input ui
        function createUI() {
            clearInputArea();

            var clsName = myGrid.className;
            //lay input boxes
            myGrid.data.forEach(function insertObject(aliasesObject) {
                //var x = document.createTextNode('For ' + clsName + ', ');
                //myGroupBox.appendChild(x);

                var x = document.createTextNode(aliasesObject.displayTxt);
                myGroupBox.appendChild(x);
                var bth = document.createElement('input');
                bth.type = 'text';
                bth.id = aliasesObject.id;
                bth.className = 'myClass';
                bth.type = aliasesObject.type;
                if (aliasesObject.type === "number") {
                    bth.min = aliasesObject.min;
                    bth.max = aliasesObject.max;
                }
                myGroupBox.appendChild(bth);
                myGroupBox.appendChild(document.createElement('br'))
            }
            );

            var clickHandler = function () {
                userInput = myReadData();
                completeObjdata();
                myGrid.data.forEach(function insertObject(aliasesObject) {
                    document.getElementById(aliasesObject.id).value = "";
                })}
                if (runCreateObj.toSubmit === true) {
                myGroupBox.appendChild(createButton('Submit', clickHandler)); 
                }


            clickHandler = function () {
                 userInput = myReadData();
                completeObjdata();
                if (runCreateObj.run == true) {
                    completeObjdata.createObj();
                }
            };
            myGroupBox.appendChild(createButton('Submit and generate chosen object', clickHandler));
        }

        //creates button object with name and click handler
        function createButton(name, clickHandler, id = '') {
            var button = document.createElement('button');
            button.innerHTML = name;
            button.onclick = clickHandler;
            button.type = "button";
            button.id = id
            return button;
        }

        function createInput(type, id, className = 'myClass', value = '') {
            var inpt = document.createElement('input');
            inpt.type = type;
            inpt.id = id;
            inpt.className = className;
            inpt.value = value;
            myGroupBox.appendChild(inpt);
            return inpt;
        }


        function newLine() {
            myGroupBox.appendChild(document.createElement('br'));
        }

        function addText(txtt) {
            myGroupBox.appendChild(document.createTextNode(txtt));
        }

        function readIntInput(myId) {
            var val = document.getElementById(myId).value;
            if (val != "") {
                return parseInt(val);
            }
        }

        function readTxtInput(myId) {
            var val = document.getElementById(myId).value;
            if (val != "") {
                return val;
            }
        }
    </script>
</body>

</html>